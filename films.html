<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Films</title>
    <link rel="stylesheet" href="styles.css"> <!-- Lien vers votre fichier CSS -->
</head>
<body>
    <header>
        <h1>Films</h1>
    </header>

    <nav>
        <ul class="nav-links">
            <li><a href="index.html">Accueil</a></li>
            <li><a href="films.html" class="active">Films</a></li>
            <li><a href="series.html">Séries</a></li>
            <li><a href="documentaires.html">Documentaires</a></li>
            <li><a href="livres.html">Livres</a></li>
        </ul>
    </nav>

    <section class="film-list" id="filmList">
        <!-- Les films seront chargés dynamiquement ici -->
        <div class="book-item">
            <img src="assets/l’ombre.png" alt="Film 2">
            <h3>L'ombre de la liberté</h3>
            <p>Durée: 110 min</p>
            <a href="lecteur-film.html">Voir plus</a>
        </div>
    </section>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";
        import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-storage.js";

        // Configuration Firebase
        const firebaseConfig = {
      apiKey: "AIzaSyAuTQI7IkG8kkxApdzrYq0iutQDMf27494",
      authDomain: "sallam-75921.firebaseapp.com",
      databaseURL: "https://sallam-75921-default-rtdb.firebaseio.com",
      projectId: "sallam-75921",
      storageBucket: "sallam-75921.appspot.com",
      messagingSenderId: "77848899514",
      appId: "1:77848899514:web:e4d976cb987e00d013f783",
      measurementId: "G-0N3QLT9GEE"
    };

        // Initialisation Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // Charger les films depuis Firestore
        async function loadMovies() {
            const filmList = document.getElementById("filmList");
            const querySnapshot = await getDocs(collection(db, "films"));

            querySnapshot.forEach(async (doc) => {
                const data = doc.data();
                const thumbnailRef = ref(storage, data.thumbnail);
                const videoUrlRef = ref(storage, data.video);

                const thumbnailUrl = await getDownloadURL(thumbnailRef);
                const videoUrl = await getDownloadURL(videoUrlRef);

                const filmItem = document.createElement("div");
                filmItem.classList.add("film-item");
                filmItem.innerHTML = `
                    <img src="${thumbnailUrl}" alt="${data.title}" class="thumbnail">
                    <h3>${data.title}</h3>
                    <p>${data.description}</p>
                    <a href="lecteur-film.html?filmUrl=${encodeURIComponent(videoUrl)}&title=${encodeURIComponent(data.title)}" target="_blank">Voir le film</a>
                `;

                filmList.appendChild(filmItem);
            });
        }

        loadMovies().catch((error) => {
            console.error("Erreur lors du chargement des films :", error);
        });
    </script>
</body>
</html>
